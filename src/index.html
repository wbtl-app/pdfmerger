<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF Merger - wbtl.app</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><defs><linearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' stop-color='%23f5a623'/><stop offset='100%25' stop-color='%23e49512'/></linearGradient></defs><rect width='32' height='32' rx='6' fill='url(%23g)'/><g transform='translate(4,4)' stroke='white' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round' fill='none'><path d='M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z'/><polyline points='14 2 14 8 20 8'/><path d='M9 15h6'/><path d='M12 12v6'/></g></svg>">
  <link rel="stylesheet" href="./styles.css">
</head>
<body>
  <header>
    <div class="header-left">
      <div class="tool-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
          <polyline points="14 2 14 8 20 8"/>
          <path d="M9 15h6"/>
          <path d="M12 12v6"/>
        </svg>
      </div>
      <div class="tool-name">PDF Merger</div>
    </div>
    <div class="header-right">
      <a href="https://wbtl.app" class="back-link">wbtl.app</a>
      <div class="theme-toggle">
        <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="5"/>
          <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
        </svg>
        <div class="toggle-switch" onclick="toggleTheme()" role="button" tabindex="0" aria-label="Toggle dark mode"></div>
        <svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
        </svg>
      </div>
    </div>
  </header>

  <main>
    <div class="content">
      <!-- Drop Zone -->
      <div id="dropZone" class="drop-zone">
        <div class="drop-zone-content">
          <svg class="drop-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
            <path d="M12 18v-6"/>
            <path d="M9 15l3-3 3 3"/>
          </svg>
          <p class="drop-text">Drop PDF files here or click to browse</p>
          <p class="drop-hint">You can add multiple files</p>
        </div>
        <input type="file" id="fileInput" accept=".pdf" multiple hidden>
      </div>

      <!-- Toolbar -->
      <div id="toolbar" class="toolbar hidden">
        <div class="toolbar-left">
          <button id="selectAllBtn" class="tool-btn" title="Select All">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2"/>
              <path d="M9 12l2 2 4-4"/>
            </svg>
            <span>Select All</span>
          </button>
          <button id="deselectBtn" class="tool-btn" title="Deselect All" disabled>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2"/>
            </svg>
            <span>Deselect</span>
          </button>
          <div class="toolbar-divider"></div>
          <button id="rotateCWBtn" class="tool-btn" title="Rotate 90Â° Clockwise" disabled>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 2v6h-6"/>
              <path d="M21 13a9 9 0 1 1-3-7.7L21 8"/>
            </svg>
            <span>Rotate</span>
          </button>
          <button id="deleteBtn" class="tool-btn danger" title="Delete Selected" disabled>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 6h18"/>
              <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"/>
              <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
            </svg>
            <span>Delete</span>
          </button>
        </div>
        <div class="toolbar-right">
          <button id="clearBtn" class="tool-btn secondary" title="Clear All">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 6L6 18"/>
              <path d="M6 6l12 12"/>
            </svg>
            <span>Clear All</span>
          </button>
          <button id="downloadBtn" class="tool-btn primary" title="Download Merged PDF">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="7 10 12 15 17 10"/>
              <line x1="12" y1="15" x2="12" y2="3"/>
            </svg>
            <span>Download</span>
          </button>
        </div>
      </div>

      <!-- Page Grid -->
      <div id="pageGrid" class="page-grid hidden"></div>

      <!-- Progress Overlay -->
      <div id="progressOverlay" class="progress-overlay hidden">
        <div class="progress-content">
          <div class="spinner"></div>
          <p id="progressText">Processing...</p>
        </div>
      </div>
    </div>
  </main>

  <script type="module" src="./main.js"></script>
  <script>
    function getSystemTheme() {
      return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    }

    function getStoredTheme() {
      return localStorage.getItem('wbtl-theme');
    }

    function setTheme(theme) {
      if (theme === 'system') {
        document.documentElement.removeAttribute('data-theme');
        localStorage.removeItem('wbtl-theme');
      } else {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('wbtl-theme', theme);
      }
    }

    function toggleTheme() {
      const current = document.documentElement.getAttribute('data-theme');
      const system = getSystemTheme();

      if (!current) {
        setTheme(system === 'dark' ? 'light' : 'dark');
      } else {
        if (current === system) {
          setTheme(current === 'dark' ? 'light' : 'dark');
        } else {
          setTheme('system');
        }
      }
    }

    (function() {
      const stored = getStoredTheme();
      if (stored) {
        setTheme(stored);
      }
    })();

    document.querySelector('.toggle-switch').addEventListener('keydown', function(e) {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        toggleTheme();
      }
    });
  </script>
</body>
</html>
